using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Security.Cryptography;
using System.Windows.Forms;
using System.Data.SqlClient;

namespace NTP_Projekt
{
    class LoginEncryption
    {

        public string RegisterInsertData(string email, string pass, string firstName, string lastName, string city, string country,
            string address, string dob, string jmbag, int role)
        {
            SqlConnection conn = new SqlConnection(Properties.Settings.Default.ntp_projektConnectionString);
            conn.Open();
            try
            {
                SqlCommand cmd = new SqlCommand();
                cmd.CommandText = "INSERT INTO users (FirstName, LastName, Email, Password, Address, City, Country, DoB, JMBAG, RoleID) " +
                    "values (@firstName, @lastName,@email, @password, @address, @city, @country, @dob, @jmbag, @role);" +
                    "INSERT INTO Students (JMBAG, EnrollmentDate) values (@jmbag, @dob)";
                cmd.Parameters.AddWithValue("@email", email);
                cmd.Parameters.AddWithValue("@firstName", firstName);
                cmd.Parameters.AddWithValue("@lastName", lastName);
                cmd.Parameters.AddWithValue("@address", address);
                cmd.Parameters.AddWithValue("@city", city);
                cmd.Parameters.AddWithValue("@country", country);
                cmd.Parameters.AddWithValue("@dob", Convert.ToDateTime(dob));
                cmd.Parameters.AddWithValue("@jmbag", jmbag);
                cmd.Parameters.AddWithValue("@password", HashString(pass, email));
                cmd.Parameters.AddWithValue("@role", role);
                cmd.Connection = conn;
                cmd.ExecuteNonQuery();
                cmd.CommandText = @"UPDATE Students
  SET Students.Image = 0xFFD8FFE000104A46494600010101006000600000FFE1005A4578696600004D4D002A00000008000503010005000000010000004A030300010000000100000000511000010000000101000000511100040000000100000EC4511200040000000100000EC400000000000186A00000B18FFFDB004300080606070605080707070909080A0C140D0C0B0B0C1912130F141D1A1F1E1D1A1C1C20242E2720222C231C1C2837292C30313434341F27393D38323C2E333432FFDB0043010909090C0B0C180D0D1832211C213232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232FFC000110802C1035D03012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00F77A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A2AA5F6A763A6C7E65EDDC302F6DEC013F41DEB97BFF00899A1DA9DB6FE75D9C1E51768FD68B09B48ECE8AF2ABAF8AF78C48B5D3E28D73C1918935913FC47F114C3E59E18B8C7EEE21F9F39A7CAC5CE8F6CA2BC1DBC73E25652A7559304638441FD29ABE36F122B6E1AACD9F7553FD29F2B173A3DEA8AF0C8BC7FE258F39D43CCCFF007E35E3F215A36FF1475B8C8F3E1B5994638DA549FD68E563E747B1515E7167F162060A2F34D7427AB44F903F035D25878EBC3D7E42ADF2C2E7A2CE367EBD3F5A5663E6474745351D2440E8CACA7A329C834EA430A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028270326B9FF001078C34BF0FC6565944D75DADE320B7E3E95E53E21F1A6A7E20631B39B7B5E9E446C403FEF7AD34AE4B9247A66B1F10344D299E2494DDCEA3EEC1CAE7D0B74FE75E7DAB7C45D6F51DC9048B67093C0887CD8FF007AB91A2A924439363A491E691A495D9DD8E5998E493EE69B4514C90A28A2800A28A2800A28A2800A28A2802ED86AFA8E9722BD95ECD060E76AB9DA7EA3A1AED748F8A5770948F54B649D33CCB1FCADF974AF3DA28B0D368FA0346F14693AE8C595D0F37BC327CAFF00977FC2B66BE675664757462ACA72083820D769A17C47D4F4DDB15FFF00A6DB8E32C71201F5EFF8D4B896A7DCF64A2B1B44F14E93AF2816772A26C64C0FF2B8FC3BFE15B35258514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400549177A8EA48BBD0047451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145159BACEB961A0D91B9BE9428FE041F79CFA01DE802F4F3C36B03CF3CA9144832CEED8007D6BCBFC51F1224B80F67A2168A3E8D73FC4C3FD9F4AE6BC4BE2DBFF0011CC448C62B40729029E3EA7D4D73F56A266E5D874923CB234923B3BB1CB331C927DCD368A299014514500145145001451450014514500145145001451450014514500145145003A392486549627649108656538208E841AEFFC3BF12EE6D4AC1AC86B88B80265037AFD7D6BCFA8A1AB8D368FA42C750B4D4ADC5C595C473C47F891B38FAFA1AB35F3BE8FAE6A1A1DD8B8B19D939F9909CA3FD477AF5EF0C78E2C35E54B79585BDF639898F0FF00EE9EFF004EB50D58D14AE7554514522828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28AE67C5DE2EB7F0E5A6C8CACB7F20FDDC59FBBEEDED403762C789BC5367E1BB40D29F32EA407CA857A9F73E82BC4F57D62F75BBE6BBBD94BB9E147651E80545A86A175AA5F4979792992690E493DBD87A0AAB56958CA52B8514514C90A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A5566470E8C5594E4107041A4A2803D13C27F1164B631D96B4ED243D16E7AB2FFBDEA3DFAD7A943347710A4D0BABC6E372B29C822BE69AE97C31E32BEF0ECAB192D3D913F340C7A7BAFA1A4D1719773DD28AA1A46B165ADD8ADD594AAEA7EF2E7E643E8476357EA0D028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28AC7F127882DBC3BA53DD4C55A56F9618B3CC8DFE03A9A00AFE2AF155AF86AC773624BC907EE61CF5F73E82BC3AF6F67D42F25BBB990BCD2B6E627FCF4A9754D52EF58BF92F2F242F239FC147A0F6AA556958CA52B8514514C90A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A28034347D66F743BF5BBB293638E194F2AC3D08AF67F0BF8BACFC496FB54AC57A8B992027B7A8F515E11525BDC4D6B711CF048D1CB19DCAEA7041A4D5CA52B1F4AD15C1F847E2043A979761AABA43778C24C4E1243EFE87F9D779516344EE145145030A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BC93E2A5E9975AB5B407E5862DC467BB1FF002BD6EBC1BC6D75F6BF175FB839547D80FB01551DC99EC73F45145519051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140057A8FC3FF19BDC491E8DA8C85E439104CC7AE06769FCB8AF2EA723B4522C884AB29C823B1A1AB8D3B1F4BD1585E12D787883438EE5B02E13F77328ECC3BFE3D6B76B3360A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A006C8DB2277FEEA935F375DCFF0069BD9E7FF9EB233FE6735EFBE27B9FB27863529BBADBB81C772303F535F3E5544CE614514551014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500771F0CB57FB1EBCDA7C8CA22BC5F973FDF1C8FCC67F4AF61AF9B6CAE5ECAFADEEA33878645914FA10735F46DBCEB736B14E9F76540E3E8466A646907A12D14515258514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400549177A8EA48BBD004745145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500729F11AE0C1E0CB94040334891F5C1FBC0F1F97F3AF11AF59F8AF73B346B1B6FF009EB397E9FDD18FFD9ABC9AAE3B194F70A28A29921451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015EE3F0FEF4DE7842D77365A12D11E72783C578757A97C27BBDD69A8599CFC8EB20FC463FA5296C54373D1E8A28A8350A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00F2DF8B3719BCD3ADF27E58D9F1DB938FE95E715DAFC4F9B7F8A563C9FDDC0A39E9CF3C57155A2D8C65B85145140828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BB8F85B71E5F89E6849004B6CD818EA4107F966B87AE97C0371F67F1A69E493B5CBC640EF9438FD7143D86B73DD28A28ACCD828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2803C37E204BE6F8C6F3E7DDB36AFD303A57315B5E2D97CEF166A52018CCC463E9C562D688C5EE145145020A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AD6F0C4BE4F8A74B9378402EA3058F605803FA564D5AD31D62D56D247385599093ED914023E8FA28A2B3370A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A291C908C4761401F3BEBB299B5FD41C8009B871C7B122B3EAC5FBB49A8DD48DF79A6763F524D57AD0C028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A4B7FF008F98BFDF1FCEA3A7C4713467D185007D2D4547036FB78DF24EE40727E9525666E14514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D14514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140053263B6090FA293FA53EA3B8FF008F697FDC3FCA803E6D95CCB2BC8460BB16207BD328A2B4300A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A747FEB17EA29B4F8866641EAC2803E8FB3FF008F1B7FFAE6BFCAA7A8EDD765B449CFCA8073F4A92B3370A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A3B8FF8F697FDC3FCAA4A82F54BD85C2AF531B01CE3B5007CDB45145686014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001525BFF00C7CC5FEF8FE751D5AD36359754B48DFEEB4CA0FE7401F47D1451599B8514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400549177A8EA48BBD0047451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500151DC7FC7B4BFEE1FE55254771FF1ED2FFB87F95007CD5451456860145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015A7E1D8D66F12E991BFDD7BA8D4FD370ACCADDF0645E778C74B5D9BB136EC63D0139FC319A182DCF7CA28A2B3370A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0029B27FAB6FA1A75046460F7A00F9B2EFF00E3F67FFAE8DFCEA1AB9AAAAA6B17C8A30AB712003D06E354EB4300A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AEABE1D45E678D6CDB38F2D246FAFC847F5AE56BB9F859116F134F26D0552D5867D0965FFEBD0F61C773D828A28ACCD828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2803E7BF12C5E4F897518F66CC4EC718F539ACAAE8BC731795E31D439CEF70DD3A640AE76B4462F70A28A28105145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140057A57C2683F7DA95C103EEA203DC7527FA579AD7ADFC2AB7D9A1DDCE40CC93E01EF8005296C54773BEA28A2A0D428A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2803C5FE264263F16B3F189214231F9571D5E87F1620C6A7613FF7A12A78F43FFD7AF3CAD16C632DC28A28A041451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015EE3F0FADCDBF83AD339FDE16907E26BC3BA9C0AFA1FC3F6BF63F0F69F6F8C6C8172318C1233FD6948B86E6951451506814514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D14514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451401E7DF162DCBE916173CE2398A1FF810CFFECB5E4F5EDDF11AD7ED3E0DB97032D03A4A0633FC583FA31AF11AB8EC653DC28A28A64851451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451401674EB7377A95ADBAE774B2AA0C0CF538AFA3D542205518551803D2BC27C0D6BF6BF1969C846551CCA4E338DAA48FD40AF77A991A4360A28A2A4B0A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00CED7AD3EDFA05FDA800B4B03AAE7D71C7EB5F3BD7D30C032953D08C57CE9AC5AFD8B59BCB6FF9E73301F4CF155133994A8A28AA2028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00EFFE14DA799AD5E5D9E90C0107D58FFF0063FAD7AD5709F0B6CCC3E1F9EE587FAF98E0FB018FE79AEEEA1EE6B1D828A28A450514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400549177A8EA48BBD00474514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015E27F11AC85AF8B66917EEDC22C9F8F43FCABDB2BCDBE2C58660B0D4147DD630B1FAF23FAD38EE4CB63CBE8A28AB320A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28ABBA3D9B6A3ACD9D9AF59A654FA0CF26803DCFC29666C7C2FA7C0C006F24337D4F3FD6B6691542285518503007A52D666E1451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D14514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400573BE38D3CEA5E11BD8D177491A8993EAA727F4C8FC6BA2A6C882589A361956041CD00CF9A28AB9AB58B69BAB5D593758642BF876FD2A9D686014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015D97C33B1FB578A85C30F96D6267FF811F947F33F9571B5EBBF0B2C3C8D0AE2F187CD712E01F65E3F9E693D8A8AD4EF28A28A8350A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00F1EF89FA6FD97C431DE2A8097518271FDE1C1FE95C3D7B57C48D33EDDE167B851992D1C4A39FE1E8DFE3F8578AD5AD8CA4ACC28A28A6485145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400E452EEA8A32CC70057D0DA1587F65E876767DE28806E3BF53FAD78D781B4BFED4F15DA232E6284F9D264765E9FAE2BDDAA646905D428A28A92C28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A280239E14B8B792090064914AB023A822BE76D56C1F4BD56E6C9F24C3215C918C8EC7F2AFA36BCAFE29E91E55E5B6AA98DB30F2A4E3F88743F97F2AA8B226B43CEA8A28AA330A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A9AD2DA5BDBC86D6152D24AE11547724D007A9FC2DD27ECFA65C6A72261EE1B621CFF0000FF00EBD7A0554D32C22D334CB7B2854048502F1DCF73F9D5BA866C9590514514861451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D1451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400564789F495D6BC3D7967B034850B45ECE395FD78FC6B5E8A00F99D9591D91C15653820F63495D9FC46D0BFB335CFB6C2B8B7BCCB70380FDC7F5AE32B4462D5985145140828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BBEF85DA39B8D5A5D5644062B65291923F8CF71F419FCEB87B4B596F6F21B5814B4B2B84503B935F40681A345A0E8F0584643141977C63731EA694995157669D1451506A145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D14514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140189E2CD1175EF0FDC5A003CE51E642DE8E3A7E7D3F1AF026564764705594E083D8D7D315E35F117C3EDA6EB26FE18C8B5BB39240E15FB8FC7AD5459135D4E2E8A28AA330A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28ADFF08787DBC43AE476ED95B6887993B63F8476FA9E9F99ED401D7FC35F0C6DFF0089E5DA73CADB29EDD416FF000AF4BA6451243124512048D00555518000A7D4377364AC828A28A430A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002B1FC53A6C5AAF86EF6DA51D233221032559790456C53261BA0907AA91FA5007CD3453A44314AF19209562A71ED4DAD0C028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00072702BDDBC13A1AE89E1E855947DA2702594F7E7A0FC05793783F4A1AC789ECED9D7742ADE64A3FD95E7F5E07E35EF80606074A9932E0BA851451526814514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D1451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005364FF56DF434EA6C9FEADBE86803E6EBBFF8FD9FFEBA37F3A86A6BBFF8FD9FFEBA37F3A86B4300A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2803D1FE13D906BAD42F88E511625FC4E4FF00215EA55C3FC2D87CBF0D4D26D23CC9C9CFAE0015DC543DCD63B05145148A0A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A922EF51D49177A008E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A2BA711DA4CECDB5551893E9C54B597E239FECDE1AD4A6C8056D9F1BBA67071FAD007CF6CC598B31CB13924F7A4A28AD0C028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A00F6AF86847FC21F10CF226933F9D75F5C1FC2A983E8175160031DC7AF5C815DE543DCDA3B05145148614514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D1451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005727F11AEFECBE0DB84190D712244083EFB8FE8A6BACAF32F8B17FCD869EA7A6E9987E83FAFE74D6E296C799D1451566214514500145145001451450014514500145145001451450014514500145145001451450014514500145145007A17C28BC11EA97D64C7FD6C424519FEE9C1FE63F2AF57AF9FBC2DA99D23C496577921049B64E7F85B83FCEBE80041190720F43532DCD20F4168A28A92C28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF05F19EA4354F14DE4CA7288DE5273D978AF5FF00166B1FD89E1CBABB500CA4797103FDE6E07E5C9FC2BC07A9C9AA89137D028A28AA330A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF75F03EB6BACF87212C479F6E04320FA0E0FE55E155D5F807C40DA36BC904AE059DD911C99FE13FC2DF9FE86935A1517667B751451506A14514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D14514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145737E33F122F87B46668C83793FCB029191EE4FD07EB40376382F891E215D4F545D3ADDF36F684EE23A349DFF2E9F9D70F4ACCCEE59892CC7249EE692B4462DDD85145140828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028048391D45145007B6F80FC49FDB9A408277DD7B6C02C9C7DE5EC6BACAF9DF43D62E342D5A1BFB7E590E190F4753C106BDF74CD4ADB56D3E2BDB57DD148323D41EE0FB8A868D62EE5BA28A2914145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D14514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514551D5756B3D16C5AEEF6511C6BC0EE58FA01DE801756D52DB46D365BEBB6DB1463A0EAC7B01EF5E0FAF6B975AFEA925E5C9C02711A0E88BD855AF1478A2EFC4B7DE64998ED633FB9841E147A9F5358356958CA52B8514514C90A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AEA3C19E2B93C3BA808A625AC2660255E7E4FF00687F5F5AE5E8A013B1F4B43345710A4D0C8B246E372B29C8229F5E39E09F1B3E8D22E9F7EC5B4F63F2B7788FF857AE5ADE5B5F40B3DACE9344DD191B22A1AB1B27727A28A290C28A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A4242A9662001C927B5002D15CEEB1E35D174746DF722798702284EE39FE42BCEF5FF0088DA96AD135B59A8B2B761862A73237FC0BB0FA534992E491DFF00893C6DA76808D1A9173798F96146E07FBC7B578FEB3AE5F6BB7AD737B296E7E4407E541E805671258924924F52692A92B19B93614514531051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140055BB1D52FB4C944965752C0C0E7E46C0FCAAA51401E99A17C523F2C3AD400F6FB4423F9AFF0087E55DF69BACE9FABC5E658DD47301D403C8FA8AF9D6A6B6BAB8B39D67B69A48655390E8C41149C4A5367D2745792E8FF146FEDBCB8B54812EA31C1953E57C7F23FA57A2E8FE23D2F5C8C3595D2B3E3989B871F854B4D1A29266AD1451486145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D1451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514555BDD46CB4E88C97975140A067E7603F4EF4016A8AE1F54F89DA4DA6E4B28E5BC907423E54CFD4FF00415C76A5F1275EBEDC903C567193C08572D8FF0078FF004C53B325C923D8EE6EEDACE3F32E678E14F57602B98D4BE2368363B962964BA901C6D8578FCCF15E3371777376E5EE6796663C92EC4D4355CA4B99E81A87C55D42652961650DBFFB721DE7F2E07F3AE5351F126B1AB717BA84D229FE0076AFE4302B2A8A7644B6D85145140828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0029C8EF1B6E466561DD4E0D368A00ECB42F88DAB697B61BC3F6EB71C6243875FA377FC6BD0F43F1B68FAD858D66FB3DC1FF0096331C1FC0F435E1540241C838229348A5268FA668AF07D0FC69AC686CAB14FE7DBF7826F997F03D47E15E89A1FC48D2F53658AF14D8CE4E06F3943FF02FF1A96996A499DA514C8A68E78C490C89221E8C8C083F8D3E91414514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D14514005145140051451400514514005145140051451400514514005145140051451400514514005145140051583AB78C345D1F72CF76AF2819F2E2F98FE95C26ABF14EFE70D1E996D1DB2918F324F9DC7B8EC3F5A76627248F53B8BAB7B488CB73347120192CEC00AE4B56F893A3586E8ED77DE4A0E3E4E17F335E497DA9DF6A7379B7B752CEFD32ED9AA955CA439F63B0D57E246B9A82B476EE9651371FB91F3FFDF479FCB15CA4F713DD48649E6795C9C9676249A8A8A7625B6C28A28A041451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450069695AFEA9A2B96D3EF24873D578653F553C577FA37C5389D163D62D8A38E3CE84654FD476AF2EA28B21A6D1F47586A963AA4225B2BA8E65233F2B723EA2ADD7CD96D75716732CD6D3490C8A72AC8C4115DB68FF0013F52B5758F54896EE1E9BD405907F4352E25A9F73D768AC0D1FC63A36B28A21BA58A66E3CA98ED6CFF5ADFA92EE1451450014514500145145001451450014514500145145001451450014514500145145001451450015245DEA3A922EF4011D145140051451400514514005145140051451400514514005145140051451400514552D4B57B0D22DCCD7D731C2BD831E5BE83BD005DA8AE6E60B381A7B99922897ABBB60579B6B1F1518ABC5A45AE0F413CDFCC2FF008D7017FAB6A1AA4A64BEBB9676273F3B703E83A0AA5121CD1EA5AD7C4DD3ACD0A69B19BC9BFBC7E541FD4D703AC78D35BD64BA4D766281B8F261F9571EFDCFE26B9FA29A488726C0924E49C9A28A298828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A000120E4706BA3D1FC71AE68E5156E8DC5BA8C7933FCC31EC7A8FCEB9CA280BD8F61D1FE266977AA91EA08D67313827EF27D73DABB3B7BA82EE2F32DE68E54FEF23023F4AF9AEADD8EA97FA64BE658DDCD6EDDFCB7233F51DE93896A7DCFA3A8AF28D2BE2A5E4584D52D5275181E645F2B7E23A1FC315DE695E2ED1757005BDEA2C981FBB94ED6FD7AD4D996A499B74514521851451400514514005145140051451400514514005145140051451400549177A8EA48BBD004745145001451450014514500145145001451450014514500145154B52D5EC348B7335F5CC70AF604F2DF41DE802ED666AFE20D3344877DF5D2236388C72EDF415E7BE21F89D3DC23DB68D19814F1F687FBF8FF006476FAD79FCD3CB732B4B3CAF248C7259D8927F1AA5121CFB1DDEB7F13EFEE58C7A4462D2307FD6BA8673F81E07EB5C3DDDE5CDF4ED3DDCF24D2B75691B26A0A2AAC436D85145140828A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028048391451401BDA578CB5CD1CAAC17AD2420E4C530DEA7DB9E47E045775A4FC52B39CAC7A9DABDBB93CC91FCC9FE35E4F4516435268FA2F4FD674ED5103595E45367F855B9FCBAD5EAF9A6296486412452323A9C8653822BA8D2BE21EBDA710B2DC0BC840C6CB8193FF007D75FCF353CA5A9F73DBA8AE3747F891A46A2C915D6EB39987FCB4E533F5AEC11D244578D95D1864329C835252698EA28A281851451400514514005145140051451400549177A8EA48BBD0047451450014514500145145001451450014514500151CF3C56D03CF3C8B1C483733B1C002B9EF11F8D74DF0F83116FB45DF68633F77FDE3DABC935DF13EA7E209B75E4D8897EE431F08BF8773EE69A5725C923BAF117C4D8E206DF4351249D0DC48BF28FA0EFF008D79ADFEA177A9DD35CDEDC3CF3375673FCBD2AB5156958CDB6C28A28A0414514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015B3A2F8A356D06406CEE9BCACFCD0C9F321FC3B7D462B1A8A00F6CF0E78F74DD6FCBB79C8B5BD618D8E7E563EC6BADAF99B383915DCF857E215D698C969AA33DCD9F015CF2F18FEA2A5C4D14FB9EC14541697705F5AC7736D22C90C832ACA6A7A92C28A28A0028A28A0028A28A002A48BBD475245DE8023A28A2800A28A2800A28A2800A28ACED675AB2D0AC1AEEF250AA07CA80FCCE7D00A00BB3CF15AC0F3CF22C7120DCCEC7000AF2FF147C499662F69A2131479C1B923E661EC0F4FAD735E26F16DFF0088EE08763159AB663814F1EC4FA9AE7EAD44CDCBB0ACCCEE5DD8B3139249C93494514C80A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A28037BC35E29BDF0E5E2BC6ED25AB1FDEDB93C37B8F43EF5ED9A3EB167AE69E9796726E46E194F543E86BE75AD7F0EF886F3C39A8ADCDB36E8DB89A127E5917FC7D0FF00F5E93572A32B1F415154B4AD52D758D3E3BCB470D1B8E467953DC1F7ABB506A145145001451450015245DEA3A922EF4011D145140051451400514565F8835CB6F0FE9525EDC1CB7DD8A3EEEDD850045E23F11DA78774F371390D2B711440F2E7FC2BC3F58D6AF75CBE6BABD999D8FDD5CFCA83D00ED49ABEAF77ADEA0F797921676E8BD947A0AA156958CA52B8514514C90A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2803A1F08F89A5F0E6AAAEC59ACE5F9668C1FC987B8FF001AF73B6B88AEEDA3B881C3C522865607A835F35D7A2FC37F1418271A25E483CA90E6DD9BB37F77F1A5245C5F43D528A28A8340A28A2800A922EF51D49177A008E8A28A0028A28A008E79E3B6B79279982471A97763D80EB5E0DE29F10CDE22D5E49CB30B643B608FB05F5C7A9AEDBE28EBBE5DBC5A2C0F8693124F83FC23EE8FCF9FC05796D5C519CDF40A28A29901451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014E8E478A5592362AE8432B0EA08A6D1401EF7E11D7D7C41A2473B3837518D93A8E3E6F5FC6B7ABC3BC09AEFF0062F88A312BE2D6EBF752E4F03FBADF81FD09AF71A86AC6B17741451452282A48BBD475245DE8023A28A2800A09C0C9E828AADA84A60D36EA503252266C7AE0500782F89B517D53C457B72EC58190AA7B28E0564D14568601451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145000090411D457BE784357FEDAF0DDADCB63CD51E5C83DD78AF03AF43F855A9F95A85D69AEDF2CC9E6A0FF006875FD3F95296C541EA7AB51451506A15245DEA3A922EF4011D1451400552D63FE40B7DFF5C1FF00F413451401F39D14515A180514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400574FF000F7FE478D3FE927FE8B6A28A1EC35B9EE545145666C15245DE8A2803FFD9";
                cmd.ExecuteNonQuery();
                MessageBox.Show("Account created!");
            }
            catch(Exception e)
            {
                if(role != 3)
                {
                    MessageBox.Show(e.Message);
                    return null;
                }
            }
            finally
            {
                conn.Close();
            }

            return null;
        }

        public static string HashString(string passwordStr,string email)
        {
            string salt = CreateSalt(email);
            string saltAndPwd = String.Concat(passwordStr, salt);
            UTF8Encoding encoder = new UTF8Encoding();
            SHA256Managed sha256hasher = new SHA256Managed();
            byte[] hashedDataBytes = sha256hasher.ComputeHash(encoder.GetBytes(saltAndPwd));
            string hashedPwd = String.Concat(byteArrayToString(hashedDataBytes), salt);
            return hashedPwd;

        }

        public static string byteArrayToString(byte[] inputArray)
        {
            StringBuilder output = new StringBuilder("");
            for (int i = 0; i < inputArray.Length; i++)
            {
                output.Append(inputArray[i].ToString("X2"));
            }
            return output.ToString();
        }

        public static byte[] GetHash(string passwordStr)
        {
            using (HashAlgorithm alg = SHA256.Create())
                return alg.ComputeHash(Encoding.UTF8.GetBytes(passwordStr));
        }

        private static string CreateSalt(string email)
        {
            string salt;
            byte[] userBytes = ASCIIEncoding.ASCII.GetBytes(email);
            long XORED = 0x00;
            foreach (int x in userBytes)
            {
                XORED = XORED ^ x;
            }
                
            
            Random rand = new Random(Convert.ToInt32(XORED));
            salt = rand.Next().ToString();
            salt += rand.Next().ToString();
            salt += rand.Next().ToString();
            salt += rand.Next().ToString();
            return salt;
        }
    }


}
